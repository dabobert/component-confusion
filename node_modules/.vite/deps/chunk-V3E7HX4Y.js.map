{
  "version": 3,
  "sources": ["../../@vidstack/react/dist/dev/chunks/vidstack-BA_GwHdf.js"],
  "sourcesContent": ["\"use client\"\n\nimport { v as onDispose, l as listenEvent, D as DOMEvent, s as signal, g as effect, H as scoped } from './vidstack-DXuea2hX.js';\nimport { b as TextTrack, i as TextTrackSymbol, w as canUsePictureInPicture, x as canUseVideoPresentation, I as IS_SERVER, y as canPlayHLSNatively } from './vidstack-BBPG_wWY.js';\nimport { H as HTMLMediaProvider } from './vidstack-BbNzE1QA.js';\nimport 'react';\nimport './vidstack-CDX6vDQH.js';\n\nclass NativeHLSTextTracks {\n  constructor(_video, _ctx) {\n    this._video = _video;\n    this._ctx = _ctx;\n    _video.textTracks.onaddtrack = this._onAddTrack.bind(this);\n    onDispose(this._onDispose.bind(this));\n  }\n  _onAddTrack(event) {\n    const nativeTrack = event.track;\n    if (!nativeTrack || findTextTrackElement(this._video, nativeTrack))\n      return;\n    const track = new TextTrack({\n      id: nativeTrack.id,\n      kind: nativeTrack.kind,\n      label: nativeTrack.label,\n      language: nativeTrack.language,\n      type: \"vtt\"\n    });\n    track[TextTrackSymbol._native] = { track: nativeTrack };\n    track[TextTrackSymbol._readyState] = 2;\n    track[TextTrackSymbol._nativeHLS] = true;\n    let lastIndex = 0;\n    const onCueChange = (event2) => {\n      if (!nativeTrack.cues)\n        return;\n      for (let i = lastIndex; i < nativeTrack.cues.length; i++) {\n        track.addCue(nativeTrack.cues[i], event2);\n        lastIndex++;\n      }\n    };\n    onCueChange(event);\n    nativeTrack.oncuechange = onCueChange;\n    this._ctx.textTracks.add(track, event);\n    track.setMode(nativeTrack.mode, event);\n  }\n  _onDispose() {\n    this._video.textTracks.onaddtrack = null;\n    for (const track of this._ctx.textTracks) {\n      const nativeTrack = track[TextTrackSymbol._native]?.track;\n      if (nativeTrack?.oncuechange)\n        nativeTrack.oncuechange = null;\n    }\n  }\n}\nfunction findTextTrackElement(video, track) {\n  return Array.from(video.children).find((el) => el.track === track);\n}\n\nclass VideoPictureInPicture {\n  constructor(_video, _media) {\n    this._video = _video;\n    this._media = _media;\n    this._onChange = (active, event) => {\n      this._media.delegate._notify(\"picture-in-picture-change\", active, event);\n    };\n    listenEvent(this._video, \"enterpictureinpicture\", this._onEnter.bind(this));\n    listenEvent(this._video, \"leavepictureinpicture\", this._onExit.bind(this));\n  }\n  get active() {\n    return document.pictureInPictureElement === this._video;\n  }\n  get supported() {\n    return canUsePictureInPicture(this._video);\n  }\n  async enter() {\n    return this._video.requestPictureInPicture();\n  }\n  exit() {\n    return document.exitPictureInPicture();\n  }\n  _onEnter(event) {\n    this._onChange(true, event);\n  }\n  _onExit(event) {\n    this._onChange(false, event);\n  }\n}\n\nclass VideoPresentation {\n  constructor(_video, _media) {\n    this._video = _video;\n    this._media = _media;\n    this._mode = \"inline\";\n    listenEvent(this._video, \"webkitpresentationmodechanged\", this._onModeChange.bind(this));\n  }\n  get _supported() {\n    return canUseVideoPresentation(this._video);\n  }\n  async _setPresentationMode(mode) {\n    if (this._mode === mode)\n      return;\n    this._video.webkitSetPresentationMode(mode);\n  }\n  _onModeChange(event) {\n    const prevMode = this._mode;\n    this._mode = this._video.webkitPresentationMode;\n    {\n      this._media.logger?.infoGroup(\"presentation mode change\").labelledLog(\"Mode\", this._mode).labelledLog(\"Event\", event).dispatch();\n    }\n    this._media.player?.dispatch(\n      new DOMEvent(\"video-presentation-change\", {\n        detail: this._mode,\n        trigger: event\n      })\n    );\n    [\"fullscreen\", \"picture-in-picture\"].forEach((type) => {\n      if (this._mode === type || prevMode === type) {\n        this._media.delegate._notify(`${type}-change`, this._mode === type, event);\n      }\n    });\n  }\n}\nclass FullscreenPresentationAdapter {\n  constructor(_presentation) {\n    this._presentation = _presentation;\n  }\n  get active() {\n    return this._presentation._mode === \"fullscreen\";\n  }\n  get supported() {\n    return this._presentation._supported;\n  }\n  async enter() {\n    this._presentation._setPresentationMode(\"fullscreen\");\n  }\n  async exit() {\n    this._presentation._setPresentationMode(\"inline\");\n  }\n}\nclass PIPPresentationAdapter {\n  constructor(_presentation) {\n    this._presentation = _presentation;\n  }\n  get active() {\n    return this._presentation._mode === \"picture-in-picture\";\n  }\n  get supported() {\n    return this._presentation._supported;\n  }\n  async enter() {\n    this._presentation._setPresentationMode(\"picture-in-picture\");\n  }\n  async exit() {\n    this._presentation._setPresentationMode(\"inline\");\n  }\n}\n\nclass VideoRemotePlaybackAdapter {\n  constructor(_video, _ctx) {\n    this._video = _video;\n    this._ctx = _ctx;\n    this._supported = signal(false);\n    this._setup();\n  }\n  get supported() {\n    return this._supported();\n  }\n  _setup() {\n    if (IS_SERVER || !this._video.remote || !this._canPrompt)\n      return;\n    this._video.remote.watchAvailability((available) => {\n      this._supported.set(available);\n    }).catch(() => {\n      this._supported.set(false);\n    });\n    effect(this._watchSupported.bind(this));\n  }\n  _watchSupported() {\n    if (!this._supported())\n      return;\n    const events = [\"connecting\", \"connect\", \"disconnect\"], onStateChange = this._onStateChange.bind(this);\n    onStateChange();\n    listenEvent(this._video, \"playing\", onStateChange);\n    for (const type of events) {\n      listenEvent(this._video.remote, type, onStateChange);\n    }\n  }\n  async prompt() {\n    if (!this.supported)\n      throw Error(\"Not supported on this platform.\");\n    if (this._type === \"airplay\" && this._video.webkitShowPlaybackTargetPicker) {\n      return this._video.webkitShowPlaybackTargetPicker();\n    }\n    return this._video.remote.prompt();\n  }\n  _onStateChange(event) {\n    const state = this._video.remote.state;\n    if (state === this._state)\n      return;\n    const detail = { type: this._type, state };\n    this._ctx.delegate._notify(\"remote-playback-change\", detail, event);\n    this._state = state;\n  }\n}\nclass VideoAirPlayAdapter extends VideoRemotePlaybackAdapter {\n  constructor() {\n    super(...arguments);\n    this._type = \"airplay\";\n  }\n  get _canPrompt() {\n    return \"WebKitPlaybackTargetAvailabilityEvent\" in window;\n  }\n}\n\nclass VideoProvider extends HTMLMediaProvider {\n  constructor(video, ctx) {\n    super(video, ctx);\n    this.$$PROVIDER_TYPE = \"VIDEO\";\n    scoped(() => {\n      this.airPlay = new VideoAirPlayAdapter(video, ctx);\n      if (canUseVideoPresentation(video)) {\n        const presentation = new VideoPresentation(video, ctx);\n        this.fullscreen = new FullscreenPresentationAdapter(presentation);\n        this.pictureInPicture = new PIPPresentationAdapter(presentation);\n      } else if (canUsePictureInPicture(video)) {\n        this.pictureInPicture = new VideoPictureInPicture(video, ctx);\n      }\n    }, this.scope);\n  }\n  get type() {\n    return \"video\";\n  }\n  setup() {\n    super.setup();\n    if (canPlayHLSNatively(this.video)) {\n      new NativeHLSTextTracks(this.video, this._ctx);\n    }\n    this._ctx.textRenderers._attachVideo(this.video);\n    onDispose(() => {\n      this._ctx.textRenderers._attachVideo(null);\n    });\n    if (this.type === \"video\")\n      this._ctx.delegate._notify(\"provider-setup\", this);\n  }\n  /**\n   * The native HTML `<video>` element.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement}\n   */\n  get video() {\n    return this._media;\n  }\n}\n\nexport { VideoProvider };\n"],
  "mappings": "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",
  "names": []
}
